{"version":3,"sources":["components/ColourPicker/Marker.module.scss","components/ColourPicker/Palette.module.scss","components/ColourPicker/HueScale.module.scss","components/ColourPicker/ColourSwatch.module.scss","components/ColourPicker/ColourPicker.module.scss","util/canvas.ts","components/ColourPicker/Marker.tsx","components/ColourPicker/Palette.tsx","components/ColourPicker/HueScale.tsx","components/ColourPicker/ColourSwatch.tsx","components/ColourPicker/ColourPicker.tsx","App.tsx","index.tsx"],"names":["module","exports","getClickCoords","element","clickEvent","boundingBox","getBoundingClientRect","x","clientX","left","y","clientY","top","getPixel","canvas","getContext","getImageData","data","getDimensions","bounds","setAttribute","String","width","height","Marker","position","onClick","style","Math","round","className","styles","marker","Palette","hue","onColourUpdate","useState","markerPosition","setMarkerPosition","last","useRef","canvasRef","event","current","coords","colour","useEffect","ctx","saturationGradient","createLinearGradient","brightnessGradient","addColorStop","fillStyle","fillRect","globalCompositeOperation","drawCanvas","palette","ref","HueScale","onHueUpdate","inferHue","hueValue","hueGradient","i","hueScale","ColourSwatch","colourSwatch","background","value","readOnly","disabled","ColourPicker","props","setColour","setHue","colourPicker","updatedColour","hexString","slice","reduce","hex","component","toString","padStart","updatedHue","defaultProps","App","console","log","href","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5d241bbe.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"colourPicker\":\"Marker_colourPicker__1Wj5V\",\"marker\":\"Marker_marker__OBBT1\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"colourPicker\":\"Palette_colourPicker__1KhTQ\",\"palette\":\"Palette_palette__1FRFn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"colourPicker\":\"HueScale_colourPicker__e4ErN\",\"hueScale\":\"HueScale_hueScale__1vD2_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"colourPicker\":\"ColourSwatch_colourPicker__1Pfi9\",\"colourSwatch\":\"ColourSwatch_colourSwatch__1zaU7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"colourPicker\":\"ColourPicker_colourPicker__1E2Ar\"};","type Position = {\n  x: number;\n  y: number;\n};\n\n/**\n * Gets the coordinates of a click event on a DOM element.\n */\nexport const getClickCoords = (\n  element: HTMLElement,\n  clickEvent: MouseEvent | React.MouseEvent\n): Position => {\n  const boundingBox = element.getBoundingClientRect();\n\n  return { x: clickEvent.clientX - boundingBox.left, y: clickEvent.clientY - boundingBox.top };\n};\n\n/**\n * Gets the pixel data from the canvas, at the specified location.\n */\nexport const getPixel = (canvas: HTMLCanvasElement, { x, y }: Position): Uint8ClampedArray | null =>\n  canvas?.getContext('2d')?.getImageData(x, y, 1, 1).data || null;\n\n/**\n * Converts an Uint8ClampedArray to a CSS hexadecimal colour, e.g. '#ff0000'.\n */\nexport const rgbaToHex = (rgbaArray: Uint8ClampedArray): string => {\n  const rgb = rgbaArray.slice(0, 3);\n  return rgb.reduce(\n    (hex: string, component: number) => hex + component.toString(16).padStart(2, '0'),\n    '#'\n  );\n};\n\n/**\n * The <canvas> element's `width` and `height` props are separate from the width and height set by\n * CSS rules; so it's necessary to infer them from the DOM and explicitly apply them to the canvas\n * (so that pixels on the canvas and screen have a 1:1 mapping).\n */\nexport const getDimensions = (canvas: HTMLCanvasElement): DOMRect => {\n  const bounds = canvas.getBoundingClientRect();\n  canvas.setAttribute('width', String(bounds.width));\n  canvas.setAttribute('height', String(bounds.height));\n\n  return bounds;\n};\n","import PropTypes, { InferProps } from 'prop-types';\nimport styles from './Marker.module.scss';\n\nexport default function Marker({\n  position: { x, y },\n  onClick,\n}: InferProps<typeof Marker.propTypes>) {\n  const style = {\n    ...(typeof x === 'number' ? { left: `${Math.round(x)}px` } : {}),\n    top: `${Math.round(y)}px`,\n  };\n\n  // eslint-disable-next-line -- because the onclick handler is just a proxy\n  return <div className={`${styles.marker} marker`} style={style} onClick={onClick} />;\n}\n\nMarker.propTypes = {\n  position: PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number.isRequired,\n  }).isRequired,\n  onClick: PropTypes.func.isRequired,\n};\n","import { useEffect, useRef, useState, MouseEvent } from 'react';\nimport PropTypes, { InferProps } from 'prop-types';\nimport { getClickCoords, getDimensions, getPixel } from '../../util/canvas';\nimport Marker from './Marker';\nimport styles from './Palette.module.scss';\n\nconst drawCanvas = (ctx: CanvasRenderingContext2D, hue: number) => {\n  const { width, height } = getDimensions(ctx.canvas);\n  const saturationGradient = ctx.createLinearGradient(0, 0, width, 0);\n  const brightnessGradient = ctx.createLinearGradient(0, 0, 0, height);\n\n  saturationGradient.addColorStop(0, `hsla(${hue},100%,50%,0)`);\n  saturationGradient.addColorStop(1, `hsla(${hue},100%,50%,1)`);\n  brightnessGradient.addColorStop(0, 'white');\n  brightnessGradient.addColorStop(1, 'black');\n\n  // Let the browser/GPU do the work...\n  ctx.fillStyle = brightnessGradient;\n  ctx.fillRect(0, 0, width, height);\n  ctx.globalCompositeOperation = 'multiply';\n  ctx.fillStyle = saturationGradient;\n  ctx.fillRect(0, 0, width, height);\n  ctx.globalCompositeOperation = 'source-over';\n};\n\nexport default function Palette({ hue, onColourUpdate }: InferProps<typeof Palette.propTypes>) {\n  const [markerPosition, setMarkerPosition] = useState({ x: 0, y: 0 });\n  const last = useRef({ hue });\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const onClick = (event: MouseEvent) => {\n    if (canvasRef.current === null) return;\n\n    const coords = getClickCoords(canvasRef.current, event);\n    const colour = getPixel(canvasRef.current, coords);\n\n    setMarkerPosition(coords);\n    onColourUpdate(colour);\n  };\n\n  useEffect(() => {\n    if (canvasRef.current === null) return;\n    const ctx = canvasRef.current.getContext('2d');\n    if (ctx === null) return;\n\n    drawCanvas(ctx, hue);\n\n    if (hue !== last.current.hue) {\n      // The hue has been changed, so we need to update the colour.\n      onColourUpdate(getPixel(canvasRef.current, markerPosition));\n    }\n\n    last.current.hue = hue;\n  }, [last, markerPosition, hue, onColourUpdate]);\n\n  return (\n    <div className={`${styles.palette} palette`}>\n      <canvas ref={canvasRef} onClick={onClick} />\n      <Marker position={markerPosition} onClick={onClick} />\n    </div>\n  );\n}\n\nPalette.propTypes = {\n  hue: PropTypes.number.isRequired,\n  onColourUpdate: PropTypes.func.isRequired,\n};\n","import { useEffect, useRef, useState, MouseEvent } from 'react';\nimport PropTypes, { InferProps } from 'prop-types';\nimport { getClickCoords, getDimensions } from '../../util/canvas';\nimport Marker from './Marker';\nimport styles from './HueScale.module.scss';\n\nconst drawCanvas = (ctx: CanvasRenderingContext2D) => {\n  const { width, height } = getDimensions(ctx.canvas);\n  const hueGradient = ctx.createLinearGradient(0, 0, 0, height);\n\n  // No visible difference between 10 and 360 color stops, so may as well save some time...\n  for (let i = 0; i <= 36; i++) {\n    hueGradient.addColorStop(1 - i / 36, `hsla(${i * 10},100%,50%,1)`);\n  }\n\n  ctx.fillStyle = hueGradient;\n  ctx.fillRect(0, 0, width, height);\n};\n\nexport default function HueScale({ onHueUpdate }: InferProps<typeof HueScale.propTypes>) {\n  const [markerPosition, setMarkerPosition] = useState({ y: 0 });\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const inferHue = (event: MouseEvent) => {\n    if (canvasRef.current === null) return;\n\n    const { y } = getClickCoords(canvasRef.current, event);\n    const hueValue = Math.round((1 - y / canvasRef.current.height) * 360);\n\n    setMarkerPosition({ y });\n    onHueUpdate(hueValue);\n  };\n\n  useEffect(() => {\n    const ctx = canvasRef?.current?.getContext('2d');\n    if (ctx) {\n      drawCanvas(ctx);\n    }\n  }, []);\n\n  return (\n    <div className={`${styles.hueScale} hueScale`}>\n      <canvas ref={canvasRef} onClick={inferHue} />\n      <Marker position={markerPosition} onClick={inferHue} />\n    </div>\n  );\n}\n\nHueScale.propTypes = {\n  onHueUpdate: PropTypes.func.isRequired,\n};\n","import PropTypes, { InferProps } from 'prop-types';\nimport styles from './ColourSwatch.module.scss';\n\nexport default function ColourSwatch({ colour }: InferProps<typeof ColourSwatch.propTypes>) {\n  return (\n    <div className={`${styles.colourSwatch} colourSwatch`}>\n      <div style={{ background: colour }} />\n      <input value={colour} readOnly disabled />\n    </div>\n  );\n}\n\nColourSwatch.propTypes = {\n  colour: PropTypes.string.isRequired,\n};\n","import { useState } from 'react';\nimport PropTypes, { InferProps } from 'prop-types';\nimport Palette from './Palette';\nimport HueScale from './HueScale';\nimport ColourSwatch from './ColourSwatch';\nimport { rgbaToHex } from '../../util/canvas';\nimport styles from './ColourPicker.module.scss';\n\n/**\n * Renders a CSS colour picker [see demo]{@link https://samchristy.github.io/ColourPicker/}\n *\n * @param onColourUpdate Callback that returns the colour as a CSS hex string.\n * @param className Optional class that can be applied to the component's wrapper <div>.\n * @param props Properties for the component's <div> wrapper.\n */\nexport default function ColourPicker({\n  onColourUpdate,\n  className,\n  ...props\n}: InferProps<typeof ColourPicker.propTypes>) {\n  const [colour, setColour] = useState('');\n  const [hue, setHue] = useState(0);\n\n  const onColourUpdateCallback = (updatedColour: Uint8ClampedArray) => {\n    const hexString = rgbaToHex(updatedColour);\n\n    onColourUpdate(hexString);\n    setColour(hexString);\n  };\n\n  return (\n    <div {...props} className={`${styles.colourPicker} colourPicker ${className}`}>\n      <Palette onColourUpdate={onColourUpdateCallback} hue={hue} />\n      <HueScale onHueUpdate={(updatedHue) => setHue(updatedHue)} />\n      <ColourSwatch colour={colour} />\n    </div>\n  );\n}\n\nColourPicker.propTypes = {\n  onColourUpdate: PropTypes.func.isRequired,\n  className: PropTypes.string,\n};\n\nColourPicker.defaultProps = {\n  className: '',\n};\n","import { ColourPicker } from './components';\nimport './App.scss';\n\nexport default function App() {\n  return (\n    <>\n      <h1>ColourPicker Demo</h1>\n      {/* eslint-disable-next-line no-console */}\n      <ColourPicker onColourUpdate={(colour) => console.log(`🎨: ${colour}`)} />\n      <p>\n        🎨Created by Sam Christy -{' '}\n        <a href=\"https://github.com/SamChristy/ColourPicker\">see code on GitHub</a>\n      </p>\n    </>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}